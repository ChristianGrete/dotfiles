#!/bin/sh -eu

__dotfiles_dir="$*"

[ ! -d "$__dotfiles_dir" -o ! -r "$__dotfiles_dir" -o ! -w "$__dotfiles_dir" ] && exit 1

[ ! -d "$__dotfiles_dir/var/etc" ] && mkdir -p "$__dotfiles_dir/var/etc"

echo "$(cat <<EOF
#
# Auto generated file
#

export DOTFILES_CLI__FILE='$PWD/opt/dotfiles.christiangrete.com/cli/bin/dotfiles'
export DOTFILES_DIR='$PWD'
export DOTFILES_REPO__DIR='$(dirname "$PWD")'
EOF
)" > "$PWD/var/etc/environment.sh"
