#!/bin/sh -eu

cd "$(dirname "$0")"

__dotfiles_cli__filename="./$(basename "$0")"

while [ -L "$__dotfiles_cli__filename" ]; do
  __dotfiles_cli__filename="$(readlink "$__dotfiles_cli__filename")"

  cd "$(dirname "$__dotfiles_cli__filename")"

  __dotfiles_cli__filename="./$(basename "$__dotfiles_cli__filename")"
done

unset -v '__dotfiles_cli__filename'

cd '..'

[ "$PWD" != "$(pwd -P)" ] && cd "$(pwd -P)"

[ -f "$PWD/etc/env.sh" -a -r "$PWD/etc/env.sh" ] && . "$PWD/etc/env.sh"

[ -x "$PWD/libexec/dotfiles-cli" ] && "$PWD/libexec/dotfiles-cli" "$@"
