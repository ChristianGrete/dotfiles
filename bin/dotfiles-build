#!/bin/sh

cd "$(dirname "$0")"

__dotfiles_build__filename="./$(basename "$0")"

while [ -L "$__dotfiles_build__filename" ]; do
  __dotfiles_build__filename="$(readlink "$__dotfiles_build__filename")"

  cd "$(dirname "$__dotfiles_build__filename")"

  __dotfiles_build__filename="./$(basename "$__dotfiles_build__filename")"
done

unset -v '__dotfiles_build__filename'

cd '..'

[ "$PWD" != "$(pwd -P)" ] && cd "$(pwd -P)"

# optspec=":hv-:"
# while getopts "$optspec" optchar; do
#   case "${optchar}" in
#     -)
#       case "${OPTARG}" in
#         loglevel)
#           val="${!OPTIND}"; OPTIND=$(( $OPTIND + 1 ))
#           echo "Parsing option: '--${OPTARG}', value: '${val}'" >&2;
#           ;;
#         loglevel=*)
#           val=${OPTARG#*=}
#           opt=${OPTARG%=$val}
#           echo "Parsing option: '--${opt}', value: '${val}'" >&2
#           ;;
#         *)
#           if [ "$OPTERR" = 1 ] && [ "${optspec:0:1}" != ":" ]; then
#             echo "Unknown option --${OPTARG}" >&2
#           fi
#           ;;
#       esac;;
#     h)
#       echo "usage: $0 [-v] [--loglevel[=]<value>]" >&2
#       exit 2
#       ;;
#     v)
#       echo "Parsing option: '-${optchar}'" >&2
#       ;;
#     *)
#       if [ "$OPTERR" != 1 ] || [ "${optspec:0:1}" = ":" ]; then
#         echo "Non-option argument: '-${OPTARG}'" >&2
#       fi
#       ;;
#   esac
# done
